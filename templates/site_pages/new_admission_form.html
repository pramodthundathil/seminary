{% extends "site_pages/index.html" %}
{% load static %}

{% block title %}
<title>Student Admission Application - Trinity Theological Seminary</title>
{% endblock %}

{% block content %}
<!-- Application Form Section -->
<section class="application-section-modern">
    <div class="form-container-modern">
        <div class="form-modal">
            <!-- Modal Header -->
            <div class="modal-header">
                <div class="header-content">
                    <i class="fas fa-graduation-cap"></i>
                    <h2>New Application Form</h2>
                </div>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                {% if messages %}
                  {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                  {% endfor %}
                {% endif %}
                
                <form method="POST" action="" class="modern-form" enctype="multipart/form-data">
                    {% csrf_token %}

                    <!-- Personal Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-user"></i>
                            <h3>Personal Information</h3>
                        </div>                     

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="first_name">First Name <span class="required">*</span></label>
                                <input type="text" id="first_name" name="first_name" 
                                       placeholder="First name" required>
                            </div>
                            <div class="form-field">
                                <label for="middle_name">Middle Name</label>
                                <input type="text" id="middle_name" name="middle_name" 
                                       placeholder="Middle name">
                            </div>
                            <div class="form-field">
                                <label for="last_name">Last Name <span class="required">*</span></label>
                                <input type="text" id="last_name" name="last_name" 
                                       placeholder="Last name" required>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="email">Email <span class="required">*</span></label>
                                <input type="email" id="email" name="email" 
                                       placeholder="student@example.com" required>
                                <span class="error-msg" id="email_error"></span>
                            </div>
                            <div class="form-field">
                                <label for="gender">Gender</label>
                                <select id="gender" name="gender">
                                    <option value="">Select Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="dob">Date of Birth</label>
                                <input type="date" id="dob" name="dob" placeholder="dd-mm-yyyy">
                            </div>
                            <div class="form-field">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" name="phone" placeholder="+1234567890">
                                <span class="error-msg" id="phone_error"></span>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="marital_status">Marital Status</label>
                                <select id="marital_status" name="marital_status">
                                    <option value="">Select Marital Status</option>
                                    <option value="single">Single</option>
                                    <option value="married">Married</option>
                                    <option value="divorced">Divorced</option>
                                    <option value="widowed">Widowed</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="spouse_name">Spouse Name</label>
                                <input type="text" id="spouse_name" name="spouse_name" 
                                       placeholder="If married">
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="citizenship">Citizenship</label>
                                <select id="citizenship" name="citizenship">
                                    <option value="">Select Country</option>
                                    {% for country in countries %}
                                    <option value="{{ country.id }}">{{ country.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="children">Children</label>
                                <input type="text" id="children" name="children" 
                                       placeholder="Number of children">
                            </div>
                        </div>
                    </div>

                    <!-- Address Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-map-marker-alt"></i>
                            <h3>Address Information</h3>
                        </div>

                        <div class="form-field full-width">
                            <label for="mailing_address">Mailing Address</label>
                            <textarea id="mailing_address" name="mailing_address" rows="3" 
                                      placeholder="Street address"></textarea>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="city">City</label>
                                <input type="text" id="city" name="city" placeholder="City">
                            </div>
                            <div class="form-field">
                                <label for="state">State/Province</label>
                                <input type="text" id="state" name="state" placeholder="State">
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="country">Country</label>
                                <select id="country" name="country">
                                    <option value="">Select Country</option>
                                    {% for country in countries %}
                                    <option value="{{ country.id }}">{{ country.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="zipcode">Zip Code</label>
                                <input type="text" id="zipcode" name="zipcode" placeholder="12345">
                            </div>
                        </div>
                    </div>

                    <!-- Academic Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-graduation-cap"></i>
                            <h3>Academic Information</h3>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="education">Highest Education</label>
                                <select id="education" name="education">
                                    <option value="">Select Education Level</option>
                                    <option value="high_school">High School</option>
                                    <option value="bachelors">Bachelor's Degree</option>
                                    <option value="masters">Master's Degree</option>
                                    <option value="doctorate">Doctorate</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="course">Course Applied</label>
                                <select id="course" name="course">
                                    <option value="">Select Course</option>
                                    {% for course in courses %}
                                    <option value="{{ course.id }}">{{ course.course_name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="start_year">Starting Year</label>
                                <select id="start_year" name="start_year">
                                    <option value="">Select Year</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="language">Language</label>
                                <select id="language" name="language">
                                    <option value="">Select Language</option>
                                    {% for language in languages %}
                                    <option value="{{ language.id }}">{{ language.language_name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="timezone">Timezone</label>
                                <select id="timezone" name="timezone">
                                    <option value="">Select Timezone</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="ministerial_status">Ministerial Status</label>
                                <select id="ministerial_status" name="ministerial_status">
                                    <option value="">Select Status</option>
                                    <option value="ordained">Ordained Minister</option>
                                    <option value="licensed">Licensed Minister</option>
                                    <option value="layperson">Layperson</option>
                                    <option value="student">Student</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-field full-width">
                            <label for="church">Church Affiliation</label>
                            <input type="text" id="church" name="church" 
                                   placeholder="Enter your church name">
                        </div>

                        <div class="form-field full-width">
                            <label for="message">Additional Message</label>
                            <textarea id="message" name="message" rows="4" 
                                      placeholder="Any additional information"></textarea>
                        </div>
                    </div>

                    <!-- Financial Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-dollar-sign"></i>
                            <h3>Financial Information</h3>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="scholarship">Scholarship Needed</label>
                                <div class="radio-group-modern">
                                    <label class="radio-label">
                                        <input type="radio" name="scholarship" value="yes">
                                        <span>Yes</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="scholarship" value="no">
                                        <span>No</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-field">
                                <label for="employed">Currently Employed</label>
                                <div class="radio-group-modern">
                                    <label class="radio-label">
                                        <input type="radio" name="employed" value="yes">
                                        <span>Yes</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="employed" value="no">
                                        <span>No</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="income">Monthly Income (USD)</label>
                                <select id="income" name="income">
                                    <option value="">Select Income Range</option>
                                    <option value="0-500">$0 - $500</option>
                                    <option value="500-1000">$500 - $1000</option>
                                    <option value="1000-2000">$1000 - $2000</option>
                                    <option value="2000+">$2000+</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label for="afford">Affordable Amount</label>
                                <select id="afford" name="afford">
                                    <option value="">Select Amount</option>
                                    <option value="25%">25%</option>
                                    <option value="50%">50%</option>
                                    <option value="75%">75%</option>
                                    <option value="100%">100%</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- References Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-users"></i>
                            <h3>References</h3>
                        </div>

                        <p class="section-note">Please provide three references: Pastor, Friend, and Relative</p>

                        <!-- Reference 1 -->
                        <h4 class="ref-title">Reference 1 (Pastor)</h4>
                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="ref1_name">Name <span class="required">*</span></label>
                                <input type="text" id="ref1_name" name="ref1_name" 
                                       placeholder="Pastor's full name" required>
                            </div>
                            <div class="form-field">
                                <label for="ref1_email">Email <span class="required">*</span></label>
                                <input type="email" id="ref1_email" name="ref1_email" 
                                       placeholder="pastor@church.com" required>
                            </div>
                            <div class="form-field">
                                <label for="ref1_phone">Phone Number</label>
                                <input type="tel" id="ref1_phone" name="ref1_phone" 
                                       placeholder="+1234567890">
                            </div>
                        </div>

                        <!-- Reference 2 -->
                        <h4 class="ref-title">Reference 2 (Friend)</h4>
                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="ref2_name">Name <span class="required">*</span></label>
                                <input type="text" id="ref2_name" name="ref2_name" 
                                       placeholder="Friend's full name" required>
                            </div>
                            <div class="form-field">
                                <label for="ref2_email">Email <span class="required">*</span></label>
                                <input type="email" id="ref2_email" name="ref2_email" 
                                       placeholder="friend@email.com" required>
                            </div>
                            <div class="form-field">
                                <label for="ref2_phone">Phone Number</label>
                                <input type="tel" id="ref2_phone" name="ref2_phone" 
                                       placeholder="+1234567890">
                            </div>
                        </div>

                        <!-- Reference 3 -->
                        <h4 class="ref-title">Reference 3 (Relative)</h4>
                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="ref3_name">Name <span class="required">*</span></label>
                                <input type="text" id="ref3_name" name="ref3_name" 
                                       placeholder="Relative's full name" required>
                            </div>
                            <div class="form-field">
                                <label for="ref3_email">Email <span class="required">*</span></label>
                                <input type="email" id="ref3_email" name="ref3_email" 
                                       placeholder="relative@email.com" required>
                            </div>
                            <div class="form-field">
                                <label for="ref3_phone">Phone Number</label>
                                <input type="tel" id="ref3_phone" name="ref3_phone" 
                                       placeholder="+1234567890">
                            </div>
                        </div>
                    </div>

                    <!-- Documents Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-file-upload"></i>
                            <h3>Upload Documents</h3>
                        </div>

                        <div class="form-field full-width">
                            <label for="profile_pic">Profile Picture</label>
                            <input type="file" id="profile_pic" name="profile_pic" accept="image/*">
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="cert1">Certificate 1 <span class="required">*</span></label>
                                <input type="file" id="cert1" name="cert1" required>
                            </div>
                            <div class="form-field">
                                <label for="cert2">Certificate 2</label>
                                <input type="file" id="cert2" name="cert2">
                            </div>
                        </div>

                        <div class="form-row-modern">
                            <div class="form-field">
                                <label for="cert3">Certificate 3</label>
                                <input type="file" id="cert3" name="cert3">
                            </div>
                            <div class="form-field">
                                <label for="cert4">Certificate 4</label>
                                <input type="file" id="cert4" name="cert4">
                            </div>
                        </div>

                        <div class="form-field">
                            <label for="cert5">Certificate 5</label>
                            <input type="file" id="cert5" name="cert5">
                        </div>
                    </div>                   

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="button" class="btn-cancel">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="submit" class="btn-save">
                            <i class="fas fa-save"></i> Save Student
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<script src="{% static 'js/timezone.js' %}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Populate starting years
        const startYearSelect = document.getElementById("start_year");
        const currentYear = new Date().getFullYear();
        for (let i = currentYear; i <= currentYear + 10; i++) {
            const option = document.createElement("option");
            option.value = i;
            option.textContent = i;
            startYearSelect.appendChild(option);
        }

        // Load timezones
        const timezoneSelect = document.getElementById("timezone");
        const timezones = Intl.supportedValuesOf('timeZone');
        timezones.sort();
        timezones.forEach(tz => {
            const option = document.createElement("option");
            option.value = tz;
            option.textContent = tz;
            timezoneSelect.appendChild(option);
        });
    });
</script>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
        {{ message }}
    </div>
  {% endfor %}
{% endif %}
{% endblock %}